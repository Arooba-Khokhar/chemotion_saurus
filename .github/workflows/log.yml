name: chemotion_saurus SSH

on:
  workflow_dispatch:
  push:
    branches: [ log ]

jobs:
  log:
    runs-on: ubuntu-latest
    steps:
      - name: Set up ssh
        env:
          SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}
        run: |
          #!/usr/bin/env bash
          set -euo pipefail
          eval $(ssh-agent -s);
          mkdir ~/.ssh/
          chmod 700 ~/.ssh
          echo "$SSH_PRIVATE_KEY" > ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa
          ssh-add ~/.ssh/id_rsa
          touch ~/.ssh/known_hosts
          ssh-keyscan github.com >> ~/.ssh/known_hosts
          chmod 600 ~/.ssh/known_hosts
          ssh -o StrictHostKeyChecking=no docusaurus@eln.chemotion.net
          echo "ECHO"
          cd /home/runner/runners/2.278.0/_diag/
          ls
          # echo "RGREP"
          # cd /
          # rgrep "af93858c" *
          #cat /var/log/auth.log
          #cd /var/log/apache2/
          #cat error.log
          #
      - name: Upload build artifacts
        uses: actions/upload-artifact@v2
        with:
          name: log_runner_0
          path: /home/runner/runners/2.278.0/_diag/
      - name: Upload build artifacts
        uses: actions/upload-artifact@v2
        with:
          name: log_runner_1
          path: /home/runner/work/_temp
